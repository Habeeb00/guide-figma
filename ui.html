<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 8px;
        font-size: 11px;
        background: #ffffff;
        color: #333;
      }
      h1 {
        font-size: 13px;
        font-weight: 600;
        margin: 0 0 8px 0;
        color: #333;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .section-title {
        font-size: 10px;
        font-weight: 600;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 6px;
        margin-top: 12px;
      }
      .section-title:first-of-type {
        margin-top: 0;
      }
      .error {
        color: #d73a49;
        background: #fdf2f2;
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid #fecaca;
        font-size: 11px;
      }
      .results {
        background: #fafafa;
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #e5e5e5;
        margin-bottom: 6px;
      }
      .guide {
        margin: 4px 0;
        font-weight: 500;
        color: #333;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 2px 0;
        font-size: 11px;
      }
      .del {
        background: #ef4444;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        transition: background 0.15s ease;
      }
      .del:hover {
        background: #dc2626;
      }
      .clear-btn {
        background: #ef4444;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        margin-top: 8px;
        width: 100%;
        transition: background 0.15s ease;
      }
      .clear-btn:hover {
        background: #dc2626;
      }
        width: 100%;
      }
      .add-section {
        background: #ffffff;
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #e5e5e5;
        margin-bottom: 12px;
      }
      .add-form {
        display: flex;
        gap: 6px;
        align-items: center;
        margin-bottom: 0;
      }
      select {
        padding: 6px 8px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 11px;
        background: #ffffff;
        color: #333;
        font-family: inherit;
        transition: border-color 0.15s ease;
        width: 80px;
        flex-shrink: 0;
      }
      input {
        padding: 6px 8px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 11px;
        background: #ffffff;
        color: #333;
        font-family: inherit;
        transition: border-color 0.15s ease;
        width: 90px;
        flex-shrink: 0;
      }
      select:focus,
      input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
      }
      .add-btn {
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 6px 8px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        transition: background 0.15s ease;
        flex-shrink: 0;
        white-space: nowrap;
      }
      .add-btn:hover {
        background: #2563eb;
      }
      .copy-paste-btns {
        display: flex;
        gap: 6px;
        margin-top: 6px;
      }
      .copy-btn {
        background: #f3f4f6;
        color: #374151;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 6px 8px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        flex: 1;
        transition: all 0.15s ease;
      }
      .copy-btn:hover {
        background: #e5e7eb;
        border-color: #9ca3af;
      }
      .paste-btn {
        background: #f3f4f6;
        color: #374151;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 6px 8px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        flex: 1;
        transition: all 0.15s ease;
      }
      .paste-btn:hover {
        background: #e5e7eb;
        border-color: #9ca3af;
      }
      .copy-dialog {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border: 1px solid #e5e5e5;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        display: none;
        min-width: 200px;
      }
      .dialog-btn {
        margin: 4px;
        padding: 8px 16px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        min-width: 80px;
        transition: all 0.15s ease;
      }
      .dialog-btn.primary {
        background: #3b82f6;
        color: white;
        border-color: #3b82f6;
      }
      .dialog-btn.primary:hover {
        background: #2563eb;
        border-color: #2563eb;
      }
      .dialog-btn.secondary {
        background: #f3f4f6;
        color: #374151;
        border-color: #d1d5db;
      }
      .dialog-btn.secondary:hover {
        background: #e5e7eb;
        border-color: #9ca3af;
      }
      .toggle-btn {
        background: #f3f4f6;
        color: #374151;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        margin-top: 8px;
        width: 100%;
        transition: all 0.15s ease;
      }
      .toggle-btn:hover {
        background: #e5e7eb;
        border-color: #9ca3af;
      }
      .eye-icon {
        margin-right: 4px;
        font-size: 12px;
      }
      .preset-section {
        background: #ffffff;
        padding: 8px;
        border-radius: 6px;
        margin-bottom: 12px;
        border: 1px solid #e5e5e5;
      }
      .preset-form {
        display: flex;
        gap: 6px;
        margin-bottom: 6px;
      }
      .preset-input {
        flex: 1;
        padding: 6px 8px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 11px;
        background: #ffffff;
        color: #333;
        font-family: inherit;
        transition: border-color 0.15s ease;
        min-width: 0;
      }
      .preset-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
      }
      .save-preset-btn {
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 6px 8px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        transition: background 0.15s ease;
        flex-shrink: 0;
        white-space: nowrap;
      }
      .save-preset-btn:hover {
        background: #2563eb;
      }
      .preset-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 4px 0;
        padding: 6px 8px;
        background: #fafafa;
        border-radius: 6px;
        border: 1px solid #e5e5e5;
      }
      .preset-name {
        font-weight: 500;
        color: #333;
        font-size: 11px;
      }
      .apply-preset-btn {
        background: #10b981;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 10px;
        font-weight: 500;
        margin-right: 4px;
        transition: background 0.15s ease;
      }
      .apply-preset-btn:hover {
        background: #059669;
      }
      .delete-preset-btn {
        background: #ef4444;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 10px;
        font-weight: 500;
        transition: background 0.15s ease;
      }
      .delete-preset-btn:hover {
        background: #dc2626;
      }
      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: #ffffff;
        border-top: 1px solid #e5e5e5;
        padding: 8px;
        display: flex;
        gap: 8px;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
      }
      .bottom-nav-item {
        flex: 1;
        background: #f3f4f6;
        color: #374151;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 11px;
        font-weight: 500;
        text-align: center;
        transition: all 0.15s ease;
      }
      .bottom-nav-item:hover {
        background: #e5e7eb;
        border-color: #9ca3af;
      }
      .main-content {
        padding-bottom: 60px;
      }
    </style>
  </head>
  <body>
    <div class="main-content">
      <h1>Frame Guides</h1>

      <div class="section-title">Add Guide</div>
      <div class="add-section">
        <div class="add-form">
          <select id="axis">
            <option value="Y">Horizontal</option>
            <option value="X">Vertical</option>
          </select>
          <input type="text" id="position" placeholder="100px or 50%" />
          <button class="add-btn" onclick="addGuide()">Add Guide</button>
        </div>
      </div>

      <div class="section-title">Current Guides</div>
      <div id="results">Select a frame...</div>

      <div class="section-title">Presets</div>
      <div class="preset-section">
      <div class="preset-form">
        <input
          type="text"
          id="presetName"
          class="preset-input"
          placeholder="Enter preset name..."
        />
        <button class="save-preset-btn" onclick="savePreset()">
          Save Preset
        </button>
      </div>
      <div id="presetList"></div>
    </div>

    <div id="copyDialog" class="copy-dialog">
      <div style="margin-bottom: 12px; font-weight: 600">Copy Guides</div>
      <div style="margin-bottom: 12px; font-size: 11px; color: #666">
        Choose how to copy the guides:
      </div>
      <div>
        <button class="dialog-btn primary" onclick="copyGuidesByType('px')">
          Copy by Pixels
        </button>
        <button class="dialog-btn primary" onclick="copyGuidesByType('%')">
          Copy by Percentage
        </button>
      </div>
      <div style="margin-top: 8px">
        <button class="dialog-btn secondary" onclick="closeCopyDialog()">
          Cancel
        </button>
      </div>
    </div>

    <div class="bottom-nav">
      <button class="bottom-nav-item" onclick="scrollToMoreWorks()">
        More Plugins
      </button>

      <button
        class="bottom-nav-item"
        onclick="window.open('https://buymeacoffee.com/habeebrahman', '_blank')"
      >
        â˜• Support creator
      </button>
    </div>

    <script>
      onmessage = (e) => {
        if (e.data.pluginMessage.type === "guides-result") {
          const data = e.data.pluginMessage.data;
          const div = document.getElementById("results");

          if (data.error) {
            div.innerHTML = `<div class="error">${data.error}</div>`;
          } else {
            const eyeIcon = data.guidesVisible ? "ï¸  " : "ðŸ™ˆ";
            const guides = data.guides.length
              ? data.guides
                  .map(
                    (g, i) =>
                      `<div class="guide"><span><span class="eye-icon">${eyeIcon}</span>${
                        g.axis === "X" ? "Vertical" : "Horizontal"
                      } at ${parseFloat(g.offset).toFixed(
                        2
                      )}px</span><button class="del" onclick="deleteGuide(${i})">Ã—</button></div>`
                  )
                  .join("")
              : "<div>No guides</div>";
            const toggleText = data.guidesVisible
              ? "Hide Guides in UI"
              : "Show Guides in UI";
            div.innerHTML = `<div class="results"><strong>${data.frameName}</strong> (${data.guidesCount})<br>${guides}<br><button class="clear-btn" onclick="clearAllGuides()">Clear All Guides</button><button class="toggle-btn" onclick="toggleGuides()">${toggleText}</button><div class="copy-paste-btns"><button class="copy-btn" onclick="copyGuides()">Copy Guides</button><button class="paste-btn" onclick="pasteGuides()">Paste Guides</button></div></div>`;
          }
        }

        if (
          e.data.pluginMessage.type === "copy-status" ||
          e.data.pluginMessage.type === "paste-status"
        ) {
          // Show brief status message
          const statusDiv = document.createElement("div");
          statusDiv.style.cssText =
            "position:fixed;top:10px;right:10px;background:#333;color:white;padding:8px;border-radius:4px;font-size:11px;z-index:1000;";
          statusDiv.textContent = e.data.pluginMessage.data.message;
          document.body.appendChild(statusDiv);
          setTimeout(() => document.body.removeChild(statusDiv), 2000);
        }

        if (e.data.pluginMessage.type === "presets-update") {
          updatePresetList(e.data.pluginMessage.data.presets);
        }
      };

      function deleteGuide(index) {
        parent.postMessage(
          { pluginMessage: { type: "delete-guide", index } },
          "*"
        );
      }

      function clearAllGuides() {
        parent.postMessage(
          { pluginMessage: { type: "clear-all-guides" } },
          "*"
        );
      }

      function addGuide() {
        const axis = document.getElementById("axis").value;
        const position = document.getElementById("position").value.trim();

        if (!position) {
          alert("Please enter a position (e.g., 100px or 50%)");
          return;
        }

        parent.postMessage(
          { pluginMessage: { type: "add-guide", axis, position } },
          "*"
        );

        // Clear input after adding
        document.getElementById("position").value = "";
      }

      function copyGuides() {
        document.getElementById("copyDialog").style.display = "block";
      }

      function closeCopyDialog() {
        document.getElementById("copyDialog").style.display = "none";
      }

      function copyGuidesByType(type) {
        parent.postMessage(
          { pluginMessage: { type: "copy-guides", copyType: type } },
          "*"
        );
        closeCopyDialog();
      }

      function pasteGuides() {
        parent.postMessage({ pluginMessage: { type: "paste-guides" } }, "*");
      }

      function toggleGuides() {
        parent.postMessage({ pluginMessage: { type: "toggle-guides" } }, "*");
      }

      function savePreset() {
        const presetName = document.getElementById("presetName").value.trim();
        if (!presetName) {
          alert("Please enter a preset name");
          return;
        }
        parent.postMessage(
          {
            pluginMessage: { type: "save-preset", presetName: presetName },
          },
          "*"
        );
        document.getElementById("presetName").value = "";
      }

      function applyPreset(presetName) {
        parent.postMessage(
          {
            pluginMessage: { type: "apply-preset", presetName: presetName },
          },
          "*"
        );
      }

      function deletePreset(presetName) {
        if (confirm(`Delete preset "${presetName}"?`)) {
          parent.postMessage(
            {
              pluginMessage: { type: "delete-preset", presetName: presetName },
            },
            "*"
          );
        }
      }

      function updatePresetList(presets) {
        const presetList = document.getElementById("presetList");
        if (Object.keys(presets).length === 0) {
          presetList.innerHTML =
            '<div style="color: #666; font-style: italic;">No presets saved</div>';
          return;
        }

        presetList.innerHTML = Object.keys(presets)
          .map(
            (name) => `
          <div class="preset-item">
            <span class="preset-name">${name}</span>
            <div>
              <button class="apply-preset-btn" onclick="applyPreset('${name}')">Apply</button>
              <button class="delete-preset-btn" onclick="deletePreset('${name}')">Ã—</button>
            </div>
          </div>
        `
          )
          .join("");
      }
      
      function scrollToMoreWorks() {
        window.open('https://www.figma.com/@habeeebi')
      }
    </script>
  </body>
</html>
